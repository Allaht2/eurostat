language: r
sudo: required
cache: packages
dist: trusty

warnings_are_errors: false

notifications:
  email:
    - leo.lahti@iki.fi

r_packages:
  - Cairo
  - jqr
  - rgdal
  - gdalUtils
  - sf
  - V8
  - geojson  
  - geojsonio
  - geojsonlint
  - jsonlite
  - protolite
  - mapview
  - rmapshaper
  - tmap
  - tmaptools  
  
r_github_packages:
  - jimhester/covr

env:
  global:
  - WARNINGS_ARE_ERRORS=1
  - r_build_args: "--no-resave-data"
  - r_check_args: "--as-cran"    
  - GITHUB_REPO: ropengov/eurostat

before_install:
  - pip install --user codecov
  - sudo apt-get -qq update
  - sudo apt-get install -y libxml2-dev libv8-dev
  - sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable --yes
  - sudo apt-get --yes --force-yes update -qq
  - sudo apt-get install --yes libudunits2-dev libproj-dev libgeos-dev
  - sudo apt-get install libgdal1-dev libgdal-dev libgeos-c1 libproj-dev
  - sudo apt-get install --yes libv8-dev    
  - sudo apt-get install --yes npm
  - sudo npm install -g mapshaper
  - sudo npm install -g geojson  

r:
- release
- devel

after_success:
  - Rscript -e 'covr::codecov()'

